---
title: '25-03-19'
eng_title: '25-03-19'
image: https://til.qriositylog.com/img/m_banner_background.jpg
sidebar_position: 23
sidebar_label: '25-03-19'
created_date: 2025-03-19
---

### 📌 Daily Report
> [https://github.com/ssginc-be/DOKI/issues/126](https://github.com/ssginc-be/DOKI/issues/126)

<br/>

### 📌 프로젝트 상황

안타깝게도 내 체력이 의지에 안 따라주는 것 같다.

모니터를 못 쳐다보겠을 정도로 편두통에 안구건조증에 묵직한 피로에 뭔지 모를 붕 뜬 느낌까지 들어서 거의 눈 감은채로 병원에 갔다.

텍스트만 보면 뭔가 생색내는거 같은데 저게 다 종합세트로 오니까 억지로 모니터 보면서 작업해도 한 70%는 멍때릴 것 같을 정도로 힘들었다.

그래서 수액 2종류 섞어 맞고 진통제도 처방받았는데, 좀 비싼게 흠이지만 기적같이 지옥에서 살아나왔다; 솔직히 기대 안했는데 무슨 미래 수명 땡겨온줄 ㅋㅋㅋ

상태가 호전돼서 다행이지만 내심 짜증이 난다.

아니 왜 체력이 협조를 안해주지?

내가 얼마나 아침에도 낮에도 저녁에도 새벽에도 개발하고 싶은데? 지금 할게 얼마나 많은데?

<br />

### 📌 무의미한 `synchronized`

예약 동시성 TDD가 드디어 마무리 되었다. 테스트는 10000명의 정원을 가진 엔트리에 대하여 50000개의 동시 예약 시도를 걸었는데, 값이 크다보니 환경 세팅도 들어가서 생각보다 까다롭더라. 일단 다음의 설정들이 필요했다.

---
1. MySQL의 max-connections 늘리기 (-> 클라이언트 접속해서 설정)
2. JVM heap memory 늘리기 (-> gradle 파일에서 설정 [[레퍼런스]](https://stackoverflow.com/questions/52733942/increase-heap-memory-for-gradle-test/52745454))
3. hikari max-pool 및 timeout 늘리기 (-> yml에서 설정)
---

하단은 별다른 처리 없이 서비스에 @Transactional만 붙인 테스트의 결과이다.

![test_result_none](https://github.com/user-attachments/assets/fdee0152-bb61-4089-874b-205734210f84)

<br />

그리고 이건 서비스에 `synchronized` 키워드를 추가한 테스트의 결과이다.

![test_result_synchronized](https://github.com/user-attachments/assets/c28f265e-1a74-4332-b927-e4cc90891f2f)

결과가 더 안좋음 ㅋㅋㅋㅋㅋㅋ

synchronized에 대한 보완책과 그 보완책의 한계점은 [여기](https://yeongchan1228.tistory.com/145)서 잘 설명해주었다.

결론적으로, 현재 상황에 필요한 조건을 단기간의 개발 일정에 만족하려면 Pessimistic Lock이 좋을 것 같다.

<br />

마지막으로, 이건 Pessimistic Lock을 적용한 결과이다.

![test_result_pm_lock](https://github.com/user-attachments/assets/a640c637-2876-4536-878a-cf3138677d41)


<br />