---
title: 'uniQ ê°œë°œ ë…¸íŠ¸'
eng_title: 'uniQ dev note'
image: https://til.qriositylog.com/img/m_banner_background.jpg
sidebar_position: 1
sidebar_label: 'uniQ ê°œë°œ ë…¸íŠ¸'
created_date: 2025-05-20
updated_date: 2025-05-28
---

:::note ë‚´ìš© ëª»ì•Œì•„ë¨¹ê² ìŒ ì£¼ì˜

Dev noteëŠ” ì •ì‹ íšŒê³ ë¡ì´ ì•„ë‹Œ draft ì…ë‹ˆë‹¤.<br />

:::

### ğŸ“† 25-05-20

ê¸°íš

<details>
<summary>ë‚´ìš© ë³´ê¸°</summary>

#### ğŸ“Œ Opened Issues
> [https://github.com/Queue-ri/uniq/issues/1](https://github.com/Queue-ri/uniq/issues/1)

<br/>

#### ğŸ“Œ í”„ë¡œì íŠ¸ ê¸°íš

í‹°ìŠ¤í† ë¦¬ -> ë„¤ì´ë²„ -> velog ë¡œ ìœ ëª©ë¯¼ ìƒí™œì„ í•´ë³¸ ê²°ê³¼, ê°ì í•˜ë‚˜ì”©ì€ ì•„ì‰¬ì›€ì´ ìˆì–´ ê·¸ëƒ¥ ìì²´ ë¸”ë¡œê·¸ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“¤ê¸°ë¡œ í–ˆë‹¤.

FE ì§€ì‹ì´ ë§ì§„ ì•Šì€ë° ë‹¹ì¥ ëª©í‘œí•˜ëŠ” ê¸°ë³¸ ê¸°ëŠ¥ë§Œ êµ¬ìƒí•´ì„œ ë§¨ë•…ì— í—¤ë”©í•˜ë ¤ í•œë‹¤.

ìš°ì„  ë‹¤ìŒì˜ ì›ì¹™ì€ ì§€ì¼œì•¼ í•œë‹¤.

<br />

#### ê¸°ëŠ¥ ì¸¡ë©´
- ê¸€ ì‘ì„±ì´ ë¹ ë¥´ê³  ì‰¬ìš°ë©´ì„œ ê²°ê³¼ë¬¼ì´ ì´ì˜ê²Œ ë‚˜ì˜¬ ê²ƒ
- ë³´í˜¸, ë¹„ê³µê°œ ê¸€ ê¸°ëŠ¥ì´ ìˆì„ ê²ƒ

#### ê´€ë¦¬ ì¸¡ë©´
- ê¸°ë³¸ ì–¸ì–´ëŠ” ì˜ì–´ (ë‚˜ì¤‘ì— i18nìœ¼ë¡œ í•œêµ­ì–´ ë„£ìŒ)
    - ì£¼ì„ í¬í•¨ ëª¨ë“  ë¬¸ì„œí™”ëŠ” ì˜ì–´ë¡œ ì‘ì„±ë˜ì–´ì•¼ í•¨

<br />

ë”°ë¼ì„œ JAMstack ê¸°ë°˜ì˜ ì •ì  í˜ì´ì§€ëŠ” ì‚¬ì‹¤ìƒ ë¶ˆê°€ëŠ¥í•˜ê³ , ì• ì´ˆì— ì •ì  í˜ì´ì§€ë¡œ ë¸”ë¡œê·¸ ìš´ì˜í• ê±°ì˜€ìœ¼ë©´ ê¸°ì¡´ì— ë„ë¦°ê±° ì£¼ì›Œë‹¤ ì¼ì„ ê²ƒì´ë‹¤.

ë³´í˜¸/ë¹„ê³µê°œ ê¸°ëŠ¥ ë•Œë¬¸ì— ê¸€ ì›ë³¸ì€ ì ‘ê·¼ì´ ì œí•œë˜ëŠ” ì˜ì—­ì— ìˆì–´ì•¼ í•˜ê³ , ì´ëŠ” self-host ë˜ëŠ” private repo í˜•ì‹ìœ¼ë¡œ ê´€ë¦¬ë˜ëŠ” ë°©ì‹ì´ ë  ê²ƒ ê°™ë‹¤.

<br />

#### ğŸ“Œ ê¸°ìˆ  ìŠ¤íƒ

- [FE] React.js
- [BE] Node.js / Express
- [DB] MongoDB

ê²€ìƒ‰ì€ algoliaë¡œ ê³ ë¯¼ì¤‘ì´ë‹¤. ESê¹Œì§„ ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§ì´ë¼ê³  ìƒê°.

**ë‚˜ì¤‘ì— ì•Œì•˜ëŠ”ë° ì´ê±¸ MERN ìŠ¤íƒì´ë¼ê³  í•˜ë”ë¼**

</details>

### ğŸ“† 25-05-21

MDX renderer êµ¬í˜„

<details>
<summary>ë‚´ìš© ë³´ê¸°</summary>

#### ğŸ“Œ í”„ë¡œì íŠ¸ ì„¸íŒ…

Node.jsë¥¼ ì˜¤ë«ë™ì•ˆ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì•˜ì—ˆëŠ”ë° ë””íœë˜ì‹œ warningì´ ëœ¨ê¸¸ë˜ ìµœì‹  LTSë¡œ ë°”ê¿”ì¤¬ë‹¤. 16 -> 22ë¡œ ì˜¬ë ¸ìœ¼ë‹ˆ ì§„ì§œ ì§•í•˜ê²Œ ì•ˆë°”ê¾¸ê¸´ í•¨.

í”„ë¡œì íŠ¸ëŠ” CRAë¡œ init í–ˆë‹¤.

<br />

#### ğŸ“Œ paddingì´ width, heightë¥¼ ê±´ë“œë¦¬ëŠ” ë¬¸ì œ

EditorSideBarì— padding ë„£ëŠ”ë° ë„£ì€ ë§Œí¼ width, heightê°€ ëŠ˜ì–´ë‚˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤.

[ìŠ¤íƒì˜¤ë²„í”Œë¡œ](https://stackoverflow.com/questions/779434/how-do-i-prevent-the-padding-property-from-changing-width-or-height-in-css)ë¥¼ ì°¸ê³ í•´ì„œ ê³ ì³¤ë‹¤.

<br />

#### ğŸ“Œ MDX ë¡œë“œí•˜ê¸°

ìŒ© CRAë¡œëŠ” MDX ë¡œë”©ì´ ì•ˆë˜ê³ , CRAì˜ Webpack ì„¤ì •ì„ ê±´ë“œë ¤ì•¼ í•œë‹¤ê³  í•œë‹¤.

í•˜ì§€ë§Œ Webpack ì„¤ì •ì´ ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê²¨ì ¸ìˆê¸° ë•Œë¬¸ì— Eject í•˜ê±°ë‚˜ cracoë¥¼ ì¨ì•¼ í–ˆê³ , ë‚˜ëŠ” craco ë°©ì‹ì„ ì„ íƒí–ˆë‹¤.

<br />

#### Webpackì´ í•˜ëŠ” ì¼
ëª¨ë“  FE ë¦¬ì†ŒìŠ¤(JS, CSS, ì´ë¯¸ì§€, í°íŠ¸ ë“±)ë¥¼ í•˜ë‚˜ì˜ JS ë²ˆë“¤ë¡œ ë³€í™˜í•˜ëŠ” ë¹Œë“œ ë„êµ¬ì´ë‹¤.

MDXê°™ì´ ë¸Œë¼ìš°ì €ê°€ ì´í•´í•  ìˆ˜ ì—†ëŠ” íŒŒì¼ì„ JS ì½”ë“œë¡œ ë³€í™˜í•´ì¤€ë‹¤.

#### MDX -> JSX ë³€í™˜ í•„ìˆ˜
ë¸Œë¼ìš°ì €ëŠ” MDXê°€ ë­”ì§€ ëª¨ë¥¸ë‹¤.

ë”°ë¼ì„œ ë¸Œë¼ìš°ì €ê°€ ì´í•´í•˜ëŠ” JSX ì½”ë“œë¡œ ë³€í™˜í•´ì£¼ì–´ì•¼ í•˜ëŠ”ë°, ì´ê±¸ í•´ì£¼ëŠ” ê²Œ

Webpack + @mdx-js/loader ì´ë‹¤.

<br />

#### ğŸ“Œ MDX ë¡œë”©ì„ ìœ„í•œ ì„¸íŒ…

1. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
npm install @craco/craco @mdx-js/react @mdx-js/loader
```

2. `package.json` ìˆ˜ì •
```json
"scripts": {
  "start": "craco start",
  "build": "craco build",
  "test": "craco test"
}
```

3. `craco.config.js` ìƒì„± ë° ì„¤ì •

```js
module.exports = {
  webpack: {
    configure: (webpackConfig) => {
      // 1. remove mdx from the rule
      webpackConfig.module.rules = webpackConfig.module.rules.map((rule) => {
        if (rule.oneOf) {
          rule.oneOf = rule.oneOf.filter(
            (r) => !(r.test && r.test.toString().includes('mdx'))
          );
        }
        return rule;
      });

      // 2. add mdx loader
      const mdxRule = {
        test: /\.mdx?$/,
        use: [
          {
            loader: require.resolve('babel-loader'),
          },
          {
            loader: require.resolve('@mdx-js/loader'),
            options: {
              providerImportSource: "@mdx-js/react",
            },
          },
        ],
      };

      const oneOfRule = webpackConfig.module.rules.find((rule) => Array.isArray(rule.oneOf));
      if (oneOfRule) {
        oneOfRule.oneOf.unshift(mdxRule);
      }

      return webpackConfig;
    },
  },
};
```

babel-loaderëŠ” ì´ë¯¸ CRAì— í¬í•¨ë˜ì–´ ìˆë‹¤.

<br />

#### ğŸ“Œ ì»´í¬ë„ŒíŠ¸ì—ì„œ MDX ë Œë”ë§í•˜ê¸°

```js
const mdxContext = require.context('../post', false, /\.mdx$/);
```

ì´ëŸ°ì‹ìœ¼ë¡œ Webpackì˜ `require.context`ë¥¼ ì´ìš©í•´ì„œ ë™ì  ë¡œë“œí•œ ë‹¤ìŒ (ì´ ë°©ì‹ ì•„ë‹ˆë©´ import ë¬¸ ì§ì ‘ ì¨ì•¼ í•˜ëŠ”ë° ë‚´ê°€ ì›í•˜ëŠ” ë°©ì‹ì´ ì•„ë‹˜)

```jsx title=EditorPage.js
<div className="content">
    {MdxComponent && (
    <MDXProvider>
        <MdxComponent />
    </MDXProvider>
    )}
</div>
```

ëŒ€ì¶© ìš”ëŸ°ì‹ìœ¼ë¡œ ë³€í™˜ëœ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.

<br />

#### ğŸ craco config ì„¤ì •ì‹œ ì£¼ì˜ì 

ê¸°ì¡´ì— gptê°€ ì•Œë ¤ì¤€ ì´ ì„¤ì •ì€ í‹€ë ¸ë‹¤.

```js
module.exports = {
  webpack: {
    configure: (webpackConfig) => {
      webpackConfig.module.rules.push({
        test: /\.mdx?$/,
        use: [
          {
            loader: require.resolve('babel-loader'),
          },
          {
            loader: require.resolve('@mdx-js/loader'),
            options: {
              providerImportSource: "@mdx-js/react",
            },
          },
        ],
      });

      return webpackConfig;
    },
  },
};
```

ì™œëƒí•˜ë©´ ë‹¨ìˆœíˆ `@mdx-js/loader`ì˜ ì„¤ì •ì„ pushë§Œ í–ˆê¸° ë•Œë¬¸ì´ë‹¤. ì´ê±´ ruleì„ ë’¤ì—ë‹¤ ë¶™ì¸ ê²ƒì´ë‹¤.

CRA Webpackì˜ ê¸°ë³¸ ì„¤ì •ì€ mdxë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” íŒŒì¼ë¡œ ê°„ì£¼í•˜ì—¬ ì •ì  íŒŒì¼ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì—

**`@mdx-js/loader`ê°€ ê¸°ì¡´ ë¡œë”ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë©´ ë¬´ì‹œëœë‹¤ (!)**

ë”°ë¼ì„œ ìµœì¢… configì—ì„  filterë¡œ ê¸°ì¡´ ë¡œë”ë¥¼ ì œê±°í•˜ê³  unshiftë¡œ ìƒˆ ë¡œë”ë¥¼ ë§¨ ì•ì— ë¶™ì—¬ì„œ ì²˜ë¦¬ ìš°ì„ ìˆœìœ„ë¥¼ í™•ë³´í–ˆë‹¤.

<br />

#### ğŸŒŒ ë Œë”ë§ ê²°ê³¼

ìš”ê¸°ê¹Œì§€ ì™„ì„±í•˜ê³  ë‚´ì¼ì˜ ë‚˜ì—ê²Œ ë§¡ê¸´ë‹¤.

![https://velog.velcdn.com/images/qriosity/post/96f18959-895d-46b4-b825-b0b07502237b/image.png](https://velog.velcdn.com/images/qriosity/post/96f18959-895d-46b4-b825-b0b07502237b/image.png)

</details>

### ğŸ“† 25-05-26

frontmatter íŒŒì‹±, `1.0.0-beta.1` ë¦´ë¦¬ì¦ˆ

<details>
<summary>ë‚´ìš© ë³´ê¸°</summary>

#### ğŸ“Œ Closed Issues
> [https://github.com/Queue-ri/uniq/issues/1](https://github.com/Queue-ri/uniq/issues/1)

<br />

#### ğŸ“Œ frontmatter íŒŒì‹±

MDXê°€ ì˜ ë Œë”ë§ë˜ëŠ” ê²ƒ ê°™ì§€ë§Œ frontmatterëŠ” ì‚¬ì‹¤ ì•ˆê·¸ë¬ë‹¤.

`-----`ë¥¼ ê¸°ì ìœ¼ë¡œ ì•ˆì˜ ë‚´ìš©ë“¤ì´ í•œ ë­‰íƒ±ì´ë¡œ ë‹¤ h2 ì²˜ë¦¬ë˜ë”ë¼.

admonitionë„ ë³„ë„ë¡œ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ frontmatterëŠ” ë©”íƒ€ë°ì´í„°ë¼ ì¤‘ìš”í•´ì„œ, ë¨¼ì € ì²˜ë¦¬í•˜ê¸°ë¡œ í–ˆë‹¤.

ëª©í‘œëŠ” ì´ëŸ¬í–ˆë‹¤.

- `title`: ê¸€ ìµœìƒë‹¨ì— h1ìœ¼ë¡œ ë Œë”ë§ & ì‚¬ì´ë“œë°”ì— ë Œë”ë§
- `created_date`: ì‚¬ì´ë“œë°”ì— ë Œë”ë§
- `updated_date`: ì‚¬ì´ë“œë°”ì— ë Œë”ë§

ê·¸ë¦¬ê³  í•˜ë‹¨ì˜ ë°©ì‹ìœ¼ë¡œ í•´ê²°í–ˆë‹¤.

1. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
npm install remark-frontmatter remark-mdx-frontmatter
```

2. craco.config.js ìˆ˜ì •

ìƒë‹¨ì— ìš”ê±° ì¶”ê°€í•˜ê³ 

```js
module.exports = async (env) => {
  const { default: remarkFrontmatter } = await import('remark-frontmatter');
  const remarkMdxFrontmatter = (await import('remark-mdx-frontmatter')).default;
  ...
```

mdxRuleì˜ optionsì— frontmatter í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í–ˆë‹¤.

```js
options: {
  providerImportSource: "@mdx-js/react",
  remarkPlugins: [
    remarkFrontmatter,
    [remarkMdxFrontmatter, { name: 'frontmatter' }],
  ],
},
...
```

`import` êµ¬ë¬¸ ì“°ëŠ”ë° ì•  ì¢€ ë¨¹ì—ˆì–´ì„œ defaultì— ëŒ€í•´ ì•Œì•„ë´ì•¼ê² ë‹¤.

ê·¸ë‚˜ì €ë‚˜ ëª¨ë“ˆë§ˆë‹¤ CJS/ESM í˜¸í™˜ ê°ˆë¦¬ëŠ”ê±° ì§„ì‹¬ íƒˆëª¨ ìš”ì†Œ ì¤‘ í•˜ë‚˜ì¸ë“¯

3. EditorPage.js, EditorSideBar.js ìˆ˜ì •

- [EditorPage.js diff](https://github.com/Queue-ri/uniq/commit/ddaf1583b283330d1d1921c2fa2d7526d8200979)
- [EditorSideBar.js diff](https://github.com/Queue-ri/uniq/commit/dcad5883477bb30d15ebf2abc82043a2b2aa0c30)

<br />

#### ğŸ“Œ ë‹¤ìŒ ë¦´ë¦¬ì¦ˆ ê³„íš

ì„œë²„ ì»´ì´ ì™€ì„œ ë†€ê³ ìˆê¸° ë•Œë¬¸ì— ì¢€ ë” ì—´ì‹¬íˆ ê°œë°œí•´ì•¼ê² ë‹¤.

ë‹¤ìŒ ë²„ì „ì—ì„  publishí•œ mdxë¥¼ ì„œë²„ìª½ìœ¼ë¡œ ë³´ë‚´ê³ , ì„œë²„ì—ì„  ì´ë¥¼ ì´ì£¼ëŠ” apië¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

ê·¸ë¦¬ê³  private gh repoì— pushê°€ ë˜ì–´ì•¼í•˜ê¸° ë•Œë¬¸ì—... ì´ë¦¬ì €ë¦¬ ê³ ë¯¼í•œ ê²°ê³¼

ë°±ì—”ë“œ APIë¥¼ í†µí•´ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì œì¼ ì •ì„ì ì¸ flowë¼ê³  ìƒê°í•œë‹¤.

ì™œëƒí•˜ë©´,

- ì¹´í…Œê³ ë¦¬ ì •ë³´ ë°›ìœ¼ë ¤ë©´ ê²°êµ­ ë°±ì—”ë“œ í†µì‹ ì´ í•„ìš”í•¨
- Electronìœ¼ë¡œ ë Œë”ë§ ë¶€ë¶„ë§Œ ë°ìŠ¤í¬íƒ‘ ì•±ìœ¼ë¡œ ë¹¼ë©´ í”„ë¡œì íŠ¸ ë³µì¡í•´ì§
- FEë‹¨ì— ë·°ì–´ì™€ private repo ì ‘ê·¼ ê¸°ëŠ¥ ëª¨ë‘ë¥¼ ë„£ìœ¼ë©´ ë³´ì•ˆìƒ ì•ˆì¢‹ìŒ.
- CORS ì˜~ ì„¤ì •í•˜ë©´ ë¡œì»¬ -> ë¦¬ëª¨íŠ¸ í†µì‹  ê°€ëŠ¥

ê·¸ë˜ì„œ ë‚´ì¼ì€ express ì‘ì—…ì„ í•  ê²ƒ ê°™ë‹¤.

</details>

### ğŸ“† 25-05-27

MDX publish API êµ¬í˜„

<details>
<summary>ë‚´ìš© ë³´ê¸°</summary>

#### ğŸ“Œ Opened Issues
> [https://github.com/Queue-ri/uniq-cms/issues/1](https://github.com/Queue-ri/uniq-cms/issues/1)

<br/>

#### ğŸ“Œ express ê¸°ë³¸ ì„¸íŒ…

ë°±ì—”ë“œ ë‹¨ í”„ë¡œì íŠ¸ ëª…ì„ `uniq-cms`ë¡œ ì •í•˜ê³  express ì„œë²„ë¡œ ì„¸íŒ…í–ˆë‹¤.

UIëŠ” `uniq` CRA í”„ë¡œì íŠ¸ì—ì„œ ë‹¤ ë§¡ê³  ìˆìœ¼ë‹ˆ `uniq-cms`ëŠ” headless CMSì¸ ê²©ì´ë‹¤.

```bash
npm install express
npm install --save-dev nodemon
```

ë””íœë˜ì‹œë¥¼ ìƒë‹¨ê³¼ ê°™ì´ ì„¤ì¹˜í•˜ê³  index.jsì™€ post.jsë¥¼ ìƒì„±í–ˆë‹¤.

```js title="index.js"
const express = require('express');
const app = express();
const port = 6229;

// parse JSON body
app.use(express.json());

// set /api prefix for all endpoints
const postRoutes = require('./routes/post');
app.use('/api/post', postRoutes);

app.listen(port, () => {
    console.log(`ğŸš€ uniq-cms running at http://localhost:${port}`);
});
```

```js title="post.js"
const express = require('express');
const router = express.Router();

router.get('/:id', (req, res) => {
    const postId = req.params.id;
    res.send(`Post content ${postId} :3`);
});

router.post('/', (req, res) => {
    res.send('Post published.');
});

module.exports = router;
```

<br />

#### ğŸ“Œ MDX Publish API êµ¬í˜„ (1/2)

Publish ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ í•´ë‹¹ MDX íŒŒì¼ì— ëŒ€í•´ ë‹¤ìŒì˜ ë‘ ê°€ì§€ë¥¼ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

1. ì„œë²„ì˜ `/post` ê²½ë¡œì— ì €ì¥
2. GH private repoì— push

ê·¸ ì¤‘ 1ë²ˆë¶€í„° ì‘ì—…í–ˆë‹¤.

<br />

#### mdx íŒŒì¼ ì €ì¥í•˜ê¸°

ì¤‘ë³µ íŒŒì¼ëª… ë¬¸ì œì— ëŒ€í•´ì„  MVP ë‹¨ê³„ì—ì„œ ìƒê°í•  ë¶€ë¶„ì´ ì•„ë‹Œ ê²ƒ ê°™ì•„ ë‚˜ì¤‘ì— ì²˜ë¦¬í•˜ê¸°ë¡œ í–ˆë‹¤.

```bash
npm install multer
```

```js title="post.js"
// temporary upload
const upload = multer({
    dest: 'temp_uploads/',
    limits: { fileSize: 10 * 1024 * 1024 }, // 10MB limit
});

/* Publish MDX file */
router.post('/', upload.single('file'), (req, res) => {
    const file = req.file;

    if (!file) {
        return res.status(400).send('No mdx file uploaded.');
    }

    // Check if the file is mdx
    if (path.extname(file.originalname) !== '.mdx') {
        fs.unlinkSync(file.path); // delete file if not mdx
        return res.status(400).send('Only mdx files are allowed.');
    }

    // set mdx save directory
    const postDir = path.join(__dirname, '../../post');

    // if not exist then mkdir
    if (!fs.existsSync(postDir)) {
        fs.mkdirSync(postDir, { recursive: true });
    }

    // final save path for the mdx file
    const targetPath = path.join(postDir, file.originalname);

    // move mdx file from temporary upload path
    fs.rename(file.path, targetPath, (err) => {
        if (err) {
            return res.status(500).send('Failed to save file.');
        }

        res.send('Post published.');
    });
});
```

#### json íŒŒì‹±í•˜ê¸°

mdx ë¿ë§Œ ì•„ë‹ˆë¼ json ë°ì´í„°ë„ ê°™ì´ í•„ìš”í•´ì§ˆ í™•ë¥ ì´ 99.99%ë¼ì„œ json íŒŒì‹± ë¡œì§ë„ ì¶”ê°€í–ˆë‹¤.

```js
// parse json
let jsonData = null;
if (req.body.json) {
    try {
        jsonData = JSON.parse(req.body.json);
    } catch (err) {
        return res.status(400).send('Invalid json payload.');
    }
}
```

```text title="console.log ê²°ê³¼"
[DEBUG] Received json: { category: 'dev-note', title: 'uniQ ê°œë°œ ë…¸íŠ¸' }
```

<br />

#### ğŸ“Œ MDX Publish API êµ¬í˜„ (2/2)

```bash
npm install simple-git
npm install dotenv
```

ì„œë²„ ìµœìƒë‹¨ì— envë¥¼ ë¶ˆëŸ¬ì˜¤ë„ë¡ ì„¤ì •í•œë‹¤.

```js
require('dotenv').config();
```

ê·¸ë¦¬ê³  repo ê¶Œí•œ ì¶”ê°€í•œ GitHub PATë¥¼ ë°œê¸‰í•˜ì—¬ envì— ë„£ëŠ”ë‹¤.

ê·¸ëŸ¼ pushí• ë•Œ sign in ì°½ì´ ì•ˆëœ¨ê³  ì•„ë¬»ë”° pushê°€ ê°€ëŠ¥í•´ì§„ë‹¤.

<br />

#### ì˜¬ë°”ë¥¸ git ì°¸ì¡°í•˜ê¸°

`simple-git`ìœ¼ë¡œ push utilì„ ë§Œë“¤ì–´ì„œ ëª¨ë“ˆí™”í•˜ê³ , ì´ ëª¨ë“ˆì„ post.jsì—ì„œ ë¶ˆëŸ¬ì™€ ì²˜ë¦¬í•˜ê³ ì í–ˆë‹¤.

ê·¸ëŸ°ë° `/post`ì—ì„œ git inití•˜ë©´ ë™ê¸°í™”ë¥¼ ëª»í•˜ê¸° ë•Œë¬¸ì—, í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê²½ë¡œì˜ gitì„ ì°¸ì¡°í•´ì•¼ í•œë‹¤.

```js
const gitPath = path.join(__dirname, '../../');
const git = simpleGit(gitPath);
```

ë”°ë¼ì„œ simpleGitì— ì´ëŸ°ì‹ìœ¼ë¡œ .gitì´ ìˆëŠ” ë£¨íŠ¸ pathë¥¼ ë„£ì–´ì¤€ë‹¤.

ì•”íŠ¼ ì´ë ‡ê²Œ í•´ì„œ [pushToGithub.js](https://github.com/Queue-ri/uniq-cms/commit/1d08e7c0fec8f64a6ec5636148c6aa8e587683a2)ë¥¼ ì‘ì„±í–ˆê³ 

publish apiì— GH push flowë¥¼ ì¶”ê°€í–ˆë‹¤. ([5e00690](https://github.com/Queue-ri/uniq-cms/commit/5e00690ea1cc0d1551fe4f5793049810d9f2b50a))

<br />

#### git ì‘ì—… ì‹œ ì°¸ê³ ì‚¬í•­

push utilë¡œ mainì— checkout í•´ì„œ pushí•˜ë ¤ë‹ˆê¹Œ í˜„ì¬ feature ë¸Œëœì¹˜ì— ìˆì–´ì„œ stash ê²½ê³ ê°€ ë–´ë‹¤.

- â¡ï¸ stashí•˜ê³  mainìœ¼ë¡œ checkout í–ˆëŠ”ë° stashë•Œë¬¸ì— util ì‘ì„±í•œê²Œ ë‹¤ ê³¼ê±°ë¡œ ëŒì•„ê° ã…‹

    - â¡ï¸ stash popì„ í–ˆëŠ”ë° merge conflictê°€ ë– ì„œ keep theirsë¡œ stash ë²„ì „ì„ ì‚´ë¦¬ê³  mainì—ì„œ util í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤.

í”„ë¡œë•ì…˜ì—ì„  ë¸Œëœì¹­í•  ì¼ì´ ì—†ì„í…Œë‹ˆ ìƒê´€ì—†ì§€ë§Œ ê°œë°œí•˜ëŠ” repoì—ì„  ì´ê±° ì¢€ ë¶ˆí¸í•˜ë‹¤. ğŸ˜

ê·¸ë¦¬ê³  publish ê´€ë ¨ ì»¤ë°‹ì„ ë‹¤ì´ë ‰íŠ¸ë¡œ mainì— ê½‚ì•„ë²„ë¦¬ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì…ì¥ì—ì„œëŠ” forkë¥¼ í†µí•œ CMS ê´€ë¦¬ê°€ ì–´ë µë‹¤. ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ pull ë•¡ê¸¸ ì‹œ ì¶©ëŒë‚˜ê¸° ë•Œë¬¸.

ì–´ë–»ê²Œ í•˜ë©´ api ë²„ì „ì—…ì´ ìš©ì´í• ì§€ëŠ” ë‹¤ìŒì˜ ê³ ë¯¼ ì‚¬í•­ì´ë‹¤.

<br />

#### ì•„ì§ DB ì—°ê²°ì€ ì•ˆë˜ì–´ìˆìŒ!

push util ìƒì˜ ì„¤ì • ì •ë³´ë“¤ì€ (ex. remote url, username ë“±) ì‚¬ìš©ìê°€ ìˆ˜ì •í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

ê·¸ë˜ì„œ DBì—ì„œ í¼ì˜¤ëŠ”ê±¸ë¡œ ì ì§„ì  ìˆ˜ì •ì„ ê±°ì³ì•¼ í•˜ëŠ”ë°

ìš°ì„  ì¡°íšŒ api ë¨¼ì € êµ¬í˜„í•´ì„œ #1 ì´ìŠˆë¥¼ ëë‚´ê³  #2ì—ì„œ ëª½ê³ DB ì‘ì—…ì„ í•  ì˜ˆì •ì´ë‹¤.

</details>

### ğŸ“† 25-05-28

MDX query API êµ¬í˜„, MongoDB ì—°ê²°, publish API DB ì—°ê²°

<details>
<summary>ë‚´ìš© ë³´ê¸°</summary>

#### ğŸ“Œ Closed Issues
> [https://github.com/Queue-ri/uniq-cms/issues/1](https://github.com/Queue-ri/uniq-cms/issues/1)

#### ğŸ“Œ Opened Issues
> [https://github.com/Queue-ri/uniq-cms/issues/3](https://github.com/Queue-ri/uniq-cms/issues/3)

<br/>

#### ğŸ“Œ MDX query API êµ¬í˜„

DB ì—°ê²°ì´ ì•ˆëœ ìƒíƒœë¼ mockìœ¼ë¡œ êµ¬ìƒ‰ë§Œ ë§ì¶°ë†“ê³  1ë²ˆ ì´ìŠˆë¥¼ ëëƒˆë‹¤.

```js title="post.js"
router.get('/:id', (req, res) => {
    const postId = req.params.id;

    if (postId === '1') {
        const filePath = path.join(__dirname, '../../post/test.mdx');

        fs.readFile(filePath, 'utf8', (err, data) => {
            if (err) {
                console.error('[Error] Failed to read MDX:', err);
                return res.status(500).send('Failed to read post file.');
            }

            res.type('text/markdown').send(data);
        });
    } else {
        res.status(404).send('Cannot find requested post.');
    }
});
```

<br />

#### ğŸ“Œ MongoDB ì—°ê²°

ë­£ëª¨ë¥´ê³  ì¼ëŠ”ë° Express 4.16.0 ì´ìƒë¶€í„° `body-parser`ê°€ ë‚´ì¥ë˜ì–´ìˆë‹¤ê³  í•œë‹¤.

```js
app.use(express.json());
```

ê·¸ë˜ì„œ index.jsì— ì´ë ‡ê²Œ ì„¤ì •í•´ì£¼ë©´ all setì´ì—ˆë˜ ê±°ì˜€ìŒ!

<br />

#### ğŸ“Œ MongoDB ì—°ê²°

```bash
npm install mongoose
```

```js title="index.js"
const mongoose = require('mongoose');

// Connect to MongoDB
mongoose.connect('mongodb://localhost:27017/uniq-cms')
.then(() => console.log('âœ… Successfully connected to MongoDB'))
.catch(err => console.error('âŒ Failed to connect to MongoDB:', err));
```

<br />

#### ğŸ“Œ Post Collection ì •ì˜

ë‹¤ìŒê³¼ ê°™ì´ Collection ìŠ¤í‚¤ë§ˆë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.

ë³„ë„ì˜ ì„¤ì •ì„ ë„£ì§€ ì•ŠëŠ”ë‹¤ë©´ ìë™ ìƒì„±ë˜ëŠ” Collectionì€ ì†Œë¬¸ì & ë³µìˆ˜í˜•ìœ¼ë¡œ ë„¤ì´ë°ëœë‹¤. (ex. Post -> posts)

`visibility`ëŠ” í¬ìŠ¤íŠ¸ ì ‘ê·¼ê¶Œí•œìœ¼ë¡œ, enumìœ¼ë¡œ ê´€ë¦¬í•˜ê¸°ë¡œ í–ˆë‹¤.

```js title="Post.js"
const mongoose = require('mongoose');

const postSchema = new mongoose.Schema({
    title: { type: String, required: true },
    category: { type: String, required: true },
    filePath: { type: String, required: true },
    visibility: {
        type: String,
        enum: ['public', 'protected', 'private'],
        default: 'public',
        required: true
    }
}, {
    timestamps: true, // automatically set createdAt and updatedAt
});

module.exports = mongoose.model('Post', postSchema);
```

<br />

#### Post Document ì €ì¥

JPAì˜ repositoryë§ˆëƒ¥ `require`ë¡œ Post ìŠ¤í‚¤ë§ˆë¥¼ ë¶ˆëŸ¬ì™€ì„œ í•„ìš”í•œ documentë¥¼ ì €ì¥í•˜ë©´ ëœë‹¤.

ì ˆëŒ€ê²½ë¡œì¸ `targetPath`ëŠ” í”„ë¡œì íŠ¸ ê²½ë¡œê¹Œì§€ í¬í•¨í•˜ê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ íŒŒì¼ì´ ì´ë™ë˜ë©´ ê´€ë¦¬í•˜ê¸° í˜ë“¤ì–´ì§„ë‹¤.

ë”°ë¼ì„œ post ê²½ë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ìƒëŒ€ê²½ë¡œë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í–ˆë‹¤.

ì´ëŸ¬ë©´ post ê²½ë¡œê°€ ë°”ë€Œì–´ë„ documentì—ëŠ” ì˜í–¥ì´ ì—†ë‹¤.

```js title="post.js"
const Post = require('../models/Post');

const projectRoot = process.cwd(); // project root path
const relativePath = path.relative(projectRoot, targetPath);

await Post.create({
    title: jsonData.title,
    category: jsonData.category,
    filePath: relativePath,
    visibility: jsonData.visibility
});
```

```json title="ì €ì¥ëœ document"
{
  "title": "uniQ ê°œë°œ ë…¸íŠ¸",
  "category": "dev-note",
  "filePath": "post\\test.mdx",
  "visibility": "protected",
  "createdAt": {
    "$date": "2025-05-28T14:13:13.519Z"
  },
  "updatedAt": {
    "$date": "2025-05-28T14:13:13.519Z"
  },
  "__v": 0
}
```

</details>