---
title: '3459 - Length of Longest V-Shaped Diagonal Segment'
eng_title: '3459 - Length of Longest V-Shaped Diagonal Segment'
image: https://til.qriosity.dev/img/m_banner_background.jpg
sidebar_label: '3459 - Length of Longest V-Shaped Diagonal Segment'
sidebar_position: 3459
created_date: 2025-08-28
---

# 3459 - Length of Longest V-Shaped Diagonal Segment

:::info

- **ë¬¸ì œ ë³´ê¸°**: [3459 - Length of Longest V-Shaped Diagonal Segment](https://leetcode.com/problems/length-of-longest-v-shaped-diagonal-segment)
- **ì†Œìš” ì‹œê°„**: 47ë¶„ 29ì´ˆ
- **í’€ì´ ì–¸ì–´**: `java`
- **ì²´ê° ë‚œì´ë„**: 3ï¸âƒ£~4ï¸âƒ£ (3.7)
- **ë¦¬ë·° íšŸìˆ˜**: âœ…

:::

<br />

### í’€ì´ í‚¤ì›Œë“œ

<details>
<summary>ìŠ¤í¬ì£¼ì˜</summary>

`DP`

</details>

<br />

### í’€ì´ ì½”ë“œ

:::info

- **ë©”ëª¨ë¦¬**: 143900 KB
- **ì‹œê°„**: 424 ms

:::

```java showLineNumbers
class Solution {
    int[] dy = {-1, -1, 1, 1}; // lu, ru, rd, ld
    int[] dx = {-1, 1, 1, -1};

    int[][] grid;
    int n, m;

    int[][][][] memo;

    int dp(int y, int x, int dir, int turned) {
        //System.out.println("dp(" + y + ", " + x + ", " + dir + ", " + turned + ")");
        if ((y == 0 || y == n-1 || x == 0 || x == m-1) && turned == 1) return 1;
        if (memo[y][x][dir][turned] != 0) return memo[y][x][dir][turned];

        int res = 0;
        int curVal = grid[y][x];
        
        // no turn
        {
            int ny = y + dy[dir];
            int nx = x + dx[dir];
            // bound check
            if (0 <= ny && ny <= n-1 && 0 <= nx && nx <= m-1) {
                int nxtVal = grid[ny][nx];
                // value check
                if (nxtVal != 1 && nxtVal != curVal)
                    res = Math.max(res, dp(ny, nx, dir, turned));
            }
        }

        // turn
        if (turned == 0) {
            int nTurned = 1; // true
            int ndir = (dir + 1) % 4;
            int ny = y + dy[ndir];
            int nx = x + dx[ndir];
            // bound check
            if (0 <= ny && ny <= n-1 && 0 <= nx && nx <= m-1) {
                int nxtVal = grid[ny][nx];
                // value check
                if (nxtVal != 1 && nxtVal != curVal)
                    res = Math.max(res, dp(ny, nx, ndir, nTurned));
            }
        }

        //System.out.println("dp(" + y + ", " + x + ", " + dir + ", " + turned + ") = " + (res+1));
        return memo[y][x][dir][turned] = res + 1;
    }

    public int lenOfVDiagonal(int[][] grid) {
        this.grid = grid;
        n = grid.length;
        m = grid[0].length;
        memo = new int[n][m][4][2];

        int mx = 0;
        int self = 0;
        for (int i = 0; i < n; ++i) {
            for (int j = 0; j < m; ++j) {
                if (grid[i][j] != 1) continue;
                self = 1; // 1 exists

                for (int d = 0; d < 4; ++d) { // 4 directions
                    int ny = i + dy[d];
                    int nx = j + dx[d];
                    // bound check
                    if (0 <= ny && ny <= n-1 && 0 <= nx && nx <= m-1) {
                        // if matches the first number of the seq
                        if (grid[ny][nx] == 2)
                            mx = Math.max(mx, dp(ny, nx, d, 0));
                    }
                }
            }
        }

        return mx == 0 ? self : mx+1;
    }
}
```

<br />

### í’€ì´ í•´ì„¤

![](https://assets.leetcode.com/uploads/2025/01/11/length_of_longest3.jpg)

ì²« ì¹¸ì€ 1, ì´í›„ë¶€í„´ 2, 0, 2, 0, ... ì‹ìœ¼ë¡œ ì´ì–´ì§€ë©°

ì§„í–‰ë°©í–¥ì€ ëŒ€ê°ì„ ë§Œ ê°€ëŠ¥í•˜ê³ , ìµœëŒ€ ë”± 1ë²ˆ ì‹œê³„ë°©í–¥ 90ë„ë¡œ ì§„í–‰ë°©í–¥ì„ êº¾ì„ ìˆ˜ ìˆì„ ë•Œ

ê°€ì¥ ê¸¸ê²Œ ë½‘ì„ ìˆ˜ ìˆëŠ” ê²½ë¡œì˜ ê¸¸ì´ë¥¼ êµ¬í•˜ëŠ” ê³ ì°¨ì› DP ë¬¸ì œì´ë‹¤.

<br />

### ğŸ¥² ì‹¤ìˆ˜ ê·¸ë§ˆì•ˆ~

ì²˜ìŒì—” turní•  ê²½ìš°ì˜ ë¡œì§ì„ ì´ë ‡ê²Œ ì„¤ì •í–ˆì—ˆê³ 

```java {2} title="êµ¬ë²„ì „ turn ë¡œì§"
// turn
if (turned == 0) {
    int nTurned = 1; // true
    int ndir = (dir + 1) % 4;
    int ny = y + dy[ndir];
    int nx = x + dx[ndir];
    ...
```

driver ë‹¨ì—ì„  ì´ˆê¸° dpë¥¼ ì´ë ‡ê²Œ í˜¸ì¶œí•˜ëŠ” ì‹¤ìˆ˜ë¥¼ í–ˆë‹¤.

```java {3} title="êµ¬ë²„ì „ driver ë¡œì§"
// if matches the first number of the seq
if (grid[ny][nx] == 2)
    mx = Math.max(mx, dp(i, j, d, 0));
```

ì¦‰, dp ì²« í˜¸ì¶œì„ 1ì´ ì“°ì¸ ì¹¸ìœ¼ë¡œ ë„˜ê²¨ë²„ë¦° ê²ƒì´ë‹¤.

ê·¸ë˜ì„œ return ë‹¨ë„ ì´ëŸ¬í–ˆë‹¤. (`mx`ëŠ” '1' ì¹¸ê¹Œì§€ í•©ì‚°ëœ ê°’)

```java title="êµ¬ë²„ì „ return ë¡œì§"
return mx == 0 ? self : mx;
```

:::note êµ¬ë²„ì „ ì½”ë“œì™€ ì „ì²´ ë¹„êµ

import DeQrypter from '@site/src/components/mdx-crypto/DeQrypter';

<DeQrypter encrypted="U2FsdGVkX1+6lX4rgD7yt2ZMWAmoSOcOGkb9j/6xfpAdhUOVIgAr35ChwsE2ZIaefgAW4FGGiP1ujPPuKtSae+Br7ggoJssqjOgLEsbNasc=" />

:::

í•˜ì§€ë§Œ ì´ëŠ” ë‹¤ìŒì˜ ì¼€ì´ìŠ¤ì—ì„œ ì–„ì§¤ì—†ì´ WA ê±¸ë ¸ëŠ”ë°

```java title="input"
[[2,0,2,0,2,0],
 [0,1,2,2,2,0],
 [2,0,1,0,2,0],
 [2,0,0,0,1,0],
 [0,0,2,0,2,0],
 [2,0,2,0,2,0],
 [2,0,2,0,2,0],
 [2,0,0,0,2,0]]
```

ì´ê²Œ ì™œ í‹€ë ¸ëƒê³ ? ë””ë²„ê¹…ì„ í•´ë³´ì.

ìƒë‹¨ì˜ í’€ì´ ì½”ë“œì—ì„œ í•´ë‹¹ êµ¬ë²„ì „ ë¡œì§ìœ¼ë¡œ ìˆ˜ì • í›„, ì£¼ì„ ë–¼ê³  ì¶œë ¥í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. (ê°€ë…ì„±ì„ ìœ„í•´ ì¤„ë°”ê¿ˆ ë„£ìŒ)

```java title="stdout"
dp(1, 1, 0, 0)

dp(0, 0, 0, 0)
dp(0, 0, 0, 0) = 1

dp(0, 2, 1, 1)
...
```

ì—¬ê¸°ì„œ `dp(0, 2, 1, 1)`ì´ ì¶œë ¥ë˜ì—ˆë‹¤ëŠ” ì ì—ì„œ ì¡°ê±´ì´ ì˜ëª»ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì™œëƒí•˜ë©´ (1, 1)ì€ ì‹œì‘ì ì¸ë°, ë°”ë¡œ ë‹¤ìŒ ì§„í–‰ ì¹¸ì¸ (0, 2)ì—ì„œ `turned`ê°€ 1(true) ì¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ëŠ” ë°©ê¸ˆ ì „ ì–¸ê¸‰í•œ, í•˜ë‹¨ì˜ ë¼ì¸ì—ì„œ ì¡°ê±´ì´ ì˜ëª»ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.

```java {2}
// turn
if (turned == 0) {
    int nTurned = 1; // true
    int ndir = (dir + 1) % 4;
    int ny = y + dy[ndir];
    int nx = x + dx[ndir];
    ...
```

ì—¬ê¸°ì„œ `turned == 0` ë¿ë§Œ ì•„ë‹ˆë¼ `curVal != 1` ì´ë¼ëŠ” ì¡°ê±´ê¹Œì§€ ì¶”ê°€ë˜ì–´ì•¼ ACë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ê·¼ë³¸ì ìœ¼ë¡œëŠ” driver ë‹¨ì—ì„œ ì²« dp í˜¸ì¶œì„ i, jë¡œ ë„˜ê²¨ë²„ë¦° ê²ƒì´ ì›ì¸ì´ê¸° ë•Œë¬¸ì—,

ìµœì¢… í’€ì´ì½”ë“œëŠ” ë‹¤ìŒì˜ 3ê°€ì§€ ìˆ˜ì •ì„ ê±°ì³ ACë¥¼ ë°›ì•˜ë‹¤.

- ì²« dpë¥¼ `ny`, `nx`ë¡œ ë„˜ê¹€
- dp ë‚´ì—ì„œ ì¡°ê±´ì„ `turned == 0`ë§Œ ì‚¬ìš©
- ìµœì¢… return ë¬¸ì—ì„  `mx`ì— '1'ì¹¸ì´ í•©ì‚°ë˜ì–´ìˆì§€ ì•Šìœ¼ë‹ˆ `mx+1`ì„ ë°˜í™˜


<br />

### ë©”ëª¨

- <span style={{fontSize: '2rem'}}>**I â¤ï¸ DP**</span>
- ê·¸ë¦¼ë§Œ ë³´ê³  ì‚¼ì„±st ë¹¡êµ¬í˜„ì¸ì¤„ ì•Œì•˜ëŠ”ë° ë‚šì˜€ë‹¤. ğŸ£
- GPT-5 mini thinking ëª¨ë“œì—ì„œ ë””ë²„ê¹… ëª»í•˜ê³  ëº‘ì´ì¹˜ê¸¸ë˜ ë‹µë‹µí•´ì„œ ë‚´ê°€ í•¨...