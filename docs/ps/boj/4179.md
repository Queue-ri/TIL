---
title: '4179 - ë¶ˆ!'
eng_title: '4179 - ë¶ˆ!'
image: https://til.qriosity.dev/img/m_banner_background.jpg
sidebar_label: '4179 - ë¶ˆ!'
sidebar_position: 4179
created_date: 2025-05-07
---

# 4179 - ë¶ˆ!


:::info

- **ë¬¸ì œ ë³´ê¸°**: [4179 - ë¶ˆ!](https://www.acmicpc.net/problem/4179)
- **ì†Œìš” ì‹œê°„**: 47ë¶„ 19ì´ˆ
- **í’€ì´ ì–¸ì–´**: `java`
- **ì²´ê° ë‚œì´ë„**: 3ï¸âƒ£~4ï¸âƒ£
- **ë¦¬ë·° íšŸìˆ˜**: âœ…

:::

<br />

### í’€ì´ í‚¤ì›Œë“œ

<details>
<summary>ìŠ¤í¬ì£¼ì˜</summary>

`bfs`

</details>

<br />

### í’€ì´ ì½”ë“œ

:::info

- **ë©”ëª¨ë¦¬**: 58084 KB
- **ì‹œê°„**: 520 ms

:::

```java
import java.io.*;
import java.util.*;

public class Main
{
    static int r, c;
    static int[][] miro;
    static boolean[][] fvisited;
    static boolean[][] jvisited;
    static Deque<int[]> fq = new ArrayDeque<>();
    static Deque<int[]> jq = new ArrayDeque<>();
    static int[] dy = {-1, 0, 0, 1};
    static int[] dx = {0, -1, 1, 0};
    
    public static int bfs() {
        // queue init was done in input()
        int time = 1;
        
		while (!jq.isEmpty()) { // until J evacuate
	        while (!fq.isEmpty() && fq.peek()[2] == time) {
    		    int[] fpos = fq.pop();
    		    for (int d = 0; d < 4; ++d) {
    		        int nfy = fpos[0] + dy[d];
    		        int nfx = fpos[1] + dx[d];
    		        if (nfy < 0 || r <= nfy || nfx < 0 || c <= nfx) continue; // out of bound
    		        if (fvisited[nfy][nfx] || miro[nfy][nfx] == 1) continue;
    		        fvisited[nfy][nfx] = true;
    		        fq.add(new int[]{nfy, nfx, time+1});
    		    }
	        }
		    
		    while (!jq.isEmpty() && jq.peek()[2] == time) {
    		    int[] jpos = jq.pop();
    		    for (int d = 0; d < 4; ++d) {
    		        int njy = jpos[0] + dy[d];
    		        int njx = jpos[1] + dx[d];
    		        if (njy < 0 || r <= njy || njx < 0 || c <= njx) return time; // evacuate
    		        if (fvisited[njy][njx] || jvisited[njy][njx] || miro[njy][njx] == 1) continue;
    		        jvisited[njy][njx] = true;
    		        jq.add(new int[]{njy, njx, time+1});
    		    }
		    }
		    ++time;
		}
		
		return -1;
    }
    
	public static void main(String[] args) throws IOException {
		input();
		int ans = bfs();
		System.out.println(ans == -1 ? "IMPOSSIBLE" : ans);
	}
	
	public static void input() throws IOException {
	    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
	    StringTokenizer st = new StringTokenizer(br.readLine());
	    r = Integer.parseInt(st.nextToken());
	    c = Integer.parseInt(st.nextToken());
	    miro = new int[r][c];
	    fvisited = new boolean[r][c];
	    jvisited = new boolean[r][c];
	    
	    for (int i = 0; i < r; ++i) {
	        char[] line = br.readLine().toCharArray();
	        for (int j = 0; j < c; ++j) {
	            miro[i][j] = line[j] == '#' ? 1 : 0;
	            if (line[j] == 'J') {
                    jq.add(new int[]{i, j, 1});
                    jvisited[i][j] = true;
	            }
	            else if (line[j] == 'F') {
	                fq.add(new int[]{i, j, 1});
	                fvisited[i][j] = true;
	            }
	        }
	    }
	}
}
```

### í’€ì´ í•´ì„¤

êµ¬í˜„ì€ ì–´ë µì§€ ì•Šì€ë° corner case ì¢…í•© ì„ ë¬¼ì„¸íŠ¸ê°™ì€ ë¬¸ì œì´ë‹¤.

ì£¼ì–´ì§„ ë§µì—ì„œ ì§€í›ˆì´ê°€ ë¶ˆì— ì•ˆíƒ€ê³  ë¬´ì‚¬ íƒˆì¶œì´ ê°€ëŠ¥í•œì§€ ë‹¥í„° ìŠ¤íŠ¸ë ˆì¸ì§€ë§ˆëƒ¥ íƒìƒ‰í•´ë³´ì•„ì•¼ í•œë‹¤.

ìµœë‹¨ ì‹œê°„ì„ ì¶œë ¥í•´ì•¼í•˜ë¯€ë¡œ bfsë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì€ ìë™ìœ¼ë¡œ ë– ì˜¤ë¥´ê²Œ ëœë‹¤.

<br />

### âš ï¸ ì‹¤ìˆ˜í•˜ê¸° ì‰¬ìš´ ë°˜ë¡€

ë‹¤ìŒì˜ ì¼€ì´ìŠ¤ë¥¼ ì¡°ì‹¬í•´ì•¼ í•œë‹¤.

<br />

:::warning CASE 1

<p style={{fontSize: '20px'}}><b>ë¶ˆì€ 0 ~ nê°œê°€ ì£¼ì–´ì§ˆ ìˆ˜ ìˆë‹¤.</b></p>

:::

> *JëŠ” ì…ë ¥ì—ì„œ í•˜ë‚˜ë§Œ ì£¼ì–´ì§„ë‹¤.*

ğŸ‘‰ ë¬¸ì œë¥¼ ì˜ ì½ì. JëŠ” ì¡°ê±´ì„ ëª…í™•í•˜ê²Œ í–ˆì§€ë§Œ Fì— ëŒ€í•´ì„  ì•„ë¬´ ë§ì´ ì—†ë‹¤. (=ë‚šì‹œì§ˆ)

```
5 5
#####
#J.F#
#..F#
#...#
#...#
```
```text title=ì •ë‹µ
4
```

<br />

```
5 5
#####
#J.F#
#...#
#..F#
#...#
```
```text title=ì •ë‹µ
IMPOSSIBLE
```

<br />

:::warning CASE 2

<p style={{fontSize: '20px'}}><b>ë¶ˆê³¼ ì§€í›ˆì´ê°€ ê°™ì€ ì§€ì ì— ë™ì‹œ ë„ì°©í•˜ë©´ ì§€í›ˆì´ê°€ íƒ€ë²„ë¦°ë‹¤.</b></p>

:::

ë¶ˆ bfsë¥¼ ë¨¼ì € ì§„í–‰í•´ì•¼í• ê¹Œ, ì§€í›ˆ bfsë¥¼ ë¨¼ì € ì§„í–‰í•´ì•¼í• ê¹Œ?

ë¶ˆì„ ë¨¼ì € ì§„í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì–´ì°¨í”¼ ë™ì‹œ ë„ì°©í•˜ëŠ” ì§€ì ì€ ë¬´íš¨í•œ íƒˆì¶œê²½ë¡œê°€ ë˜ê¸° ë•Œë¬¸ì—

ì• ë‹¹ì´ˆ bfs íì— ì•ˆë„£ëŠ” ê²ƒì´ ìµœì ì˜ ì„ íƒì¼ ê²ƒì´ë‹¤.

<br />

:::warning CASE 3

<p style={{fontSize: '20px'}}><b>ì‹œì‘ë¶€í„° ì§€í›ˆì´ê°€ ê²½ê³„ì— ìˆëŠ” ê²½ìš°</b></p>

:::

í’€ì´ ì½”ë“œì²˜ëŸ¼

```java
if (njy < 0 || r <= njy || njx < 0 || c <= njx) return time; // evacuate
```

ì´ë ‡ê²Œ íƒˆì¶œ ì¡°ê±´ì„ **out-bound ê¸°ì¤€ìœ¼ë¡œ ì„¸ì› ë‹¤ë©´** ì‹œì‘ë¶€í„° ê²½ê³„ì— ìˆëŠ” ê²½ìš°ë¥¼ ë”°ë¡œ ì²˜ë¦¬í•´ì¤„ í•„ìš”ê°€ ì—†ë‹¤.

í•˜ì§€ë§Œ yê°€ 0 ë˜ëŠ” r-1, xê°€ 0 ë˜ëŠ” c-1 ì¸ ê²½ìš°ë¡œ íƒˆì¶œ ì¡°ê±´ì„ ì„¸ì› ë‹¤ë©´, ì´ë¥¼ ny, nxë¡œ íŒë‹¨í•˜ë©´ ì•ˆë˜ê¸°ì—

bfsì—ì„œ while ë“¤ì–´ê°€ê¸° ì „ ì´ˆê¸°ê°’ì„ í•œë²ˆ ê²€ì‚¬í•´ì£¼ëŠ” ë³„ë„ì˜ ë¡œì§ì´ í•„ìš”í•´ì§„ë‹¤.

```
1 3
J#F
```
```text title=ì •ë‹µ
1
```

<br />

### ë©”ëª¨

- ë”ë¸” bfsëŠ” ì›¬ë§Œí•˜ë©´ while ì•ˆì— while 2ê°œ ëŒì•„ê°„ë‹¤ê³  í…œí”Œë¦¿ ì¡ì•„ë†“ê¸°
- ë‹¤ì‹œëŠ” `while (!q.isEmpty())` ë¡œì§ ë‚´ë¶€ì— `while (q.peek()[2] == ...)` ë¡œì§ ë„£ëŠ” ì‹¤ìˆ˜í•˜ì§€ ë§ˆì‡¼ ì´ê±´ ê²½ê³ ìš”...
    - `q.pop()` í•˜ë‹¤ê°€ peekì—ì„œ ë„ìµì…‰ì…˜ í„°ì§ T~T